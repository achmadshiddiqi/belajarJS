<!-- Header -->
<%- include('./layouts/header') %>
<!-- Navbar -->
<%- include('./layouts/nav') %>
<!-- Content -->
<div class="container">
  <div class="row mt-5">
    <div class="col-md-3"></div>
    <div class="col-md-6">
      <h1 class="text-center users-title">Users</h1>
      <% if (msg.length !== 0) { %>
      <div class="alert alert-success" role="alert"><%= msg %></div>
      <% } %>
      <table class="table table-striped">
        <thead>
          <tr>
            <th scope="col">No.</th>
            <th scope="col">Username</th>
            <th scope="col">Role</th>
            <% if (loggedUser.role ==='admin') { %>
            <th scope="col">Actions</th>
            <% } %>
          </tr>
        </thead>
        <tbody>
          <% users.forEach((user, i) => { %>
          <tr>
            <th scope="row"><%= i+1 %></th>
            <td><%= user.username %></td>
            <td><%= user.role %></td>
            <% if (loggedUser.role === 'admin') { %>
            <td>
              <% if (loggedUser.username !== user.username) { %>
              <a
                href="/users/update/<%= user.username %>"
                class="btn btn-warning"
                >Update</a
              >
              <a
                href="/users/delete/<%= user.username %>"
                class="btn btn-danger"
                >Delete</a
              >
              <% } %>
            </td>
            <% } %>
          </tr>
          <% }) %>
        </tbody>
      </table>
      <form method="POST" action="/login/logout" class="form-control">
        <button type="submit" class="btn btn-primary">Logout</button>
      </form>
    </div>
    <div class="col-md-3"></div>
  </div>
</div>
<!-- Footer -->
<%- include('./layouts/footer') %>
